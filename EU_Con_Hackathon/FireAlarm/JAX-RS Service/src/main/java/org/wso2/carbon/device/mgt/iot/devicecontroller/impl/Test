INSERT overwrite TABLE DeviceTemperatureSummaryData SELECT
                                                      temperature,
                                                      deviceId,
                                                      owner,
                                                      year(from_unixtime(cast(time / 1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss.SSS'))  AS year,
                                                      month(from_unixtime(cast(time / 1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss.SSS')) AS month,
                                                      day(from_unixtime(cast(time / 1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss.SSS')) AS day,
                                                      concat(substring(from_unixtime(cast(time / 1000 AS BIGINT), 'yyyy-MM-ddHH:mm:ss'), 0, 19)) AS time


                                                    FROM DeviceTemperatureData
                                                    GROUP BY temperature, deviceId,
                                                      owner,
                                                      year(from_unixtime(cast(time / 1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss.SSS')),
                                                      month(from_unixtime(cast(time / 1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss.SSS')),
                                                      day(from_unixtime(cast(time / 1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss.SSS')),
                                                      hour(from_unixtime(cast(time / 1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss.SSS')),
                                                      minute(from_unixtime(cast(time / 1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss.SSS')),
                                                      substring(from_unixtime(cast(time / 1000 AS BIGINT),'yyyy-MM-dd HH:mm:ss'), 0, 19);